# ulogd.conf для ZeroTier Sidecar Connection Logging
# Логирует NFLOG подключения в человекочитаемый формат

[global]
# Стек плагинов для обработки логов
stack=log1:NFLOG,base1:BASE,ifi1:IFINDEX,ip2str1:IP2STR,print1:PRINTPKT,emu1:LOGEMU

# NFLOG Plugin - получает логи из iptables NFLOG
[log1]
group=1
# Размер буфера для NFLOG сообщений
nlbufsiz=160000

# BASE plugin - базовая обработка пакетов
[base1]

# IFINDEX plugin - конвертирует interface index в имя
[ifi1]

# IP2STR plugin - конвертирует IP адреса в строки
[ip2str1]

# PRINTPKT plugin - форматирует вывод
[print1]

# LOGEMU plugin - записывает в файл в формате похожем на syslog
[emu1]
file="/var/log/zerotier-sidecar/connections.log"
# Формат: timestamp + информация о пакете
sync=1
