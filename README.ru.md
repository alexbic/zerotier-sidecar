# üåê ZeroTier Sidecar Gateway v2.2

[![Docker Pulls](https://img.shields.io/docker/pulls/alexbic/zerotier-sidecar)](https://hub.docker.com/r/alexbic/zerotier-sidecar)
[![Docker Image Size](https://img.shields.io/docker/image-size/alexbic/zerotier-sidecar/latest)](https://hub.docker.com/r/alexbic/zerotier-sidecar)
[![License](https://img.shields.io/github/license/alexbic/zerotier-sidecar)](LICENSE)
[![GitHub Stars](https://img.shields.io/github/stars/alexbic/zerotier-sidecar)](https://github.com/alexbic/zerotier-sidecar/stargazers)

[üá∫üá∏ English](README.md) | üá∑üá∫ –†—É—Å—Å–∫–∏–π

–ú–æ—â–Ω—ã–π Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–π—Å—Ç–≤—É–µ—Ç –∫–∞–∫ –º–æ—Å—Ç ZeroTier —Å–µ—Ç–∏ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Ä–µ–∂–∏–º–∞–º–∏ —Ä–∞–±–æ—Ç—ã:
- **–†–µ–∂–∏–º Backend**: ZeroTier —Å–µ—Ç–∏ ‚Üí Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã  
- **–†–µ–∂–∏–º Gateway**: –ò–Ω—Ç–µ—Ä–Ω–µ—Ç ‚Üí ZeroTier —Å–µ—Ç–∏ (–ù–û–í–û–ï!)
- **–ì–∏–±—Ä–∏–¥–Ω—ã–π —Ä–µ–∂–∏–º**: –û–±–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

–ò–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Ü–µ–ø–æ—á–µ–∫ –¥–æ—Å—Ç—É–ø–∞ –∏ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–∏—Å–∞–º —á–µ—Ä–µ–∑ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—É—é —Å–µ—Ç—å ZeroTier.

## üê≥ Docker –æ–±—Ä–∞–∑—ã

Docker –æ–±—Ä–∞–∑—ã –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞ **Docker Hub** –∏ **GitHub Container Registry**:

**Docker Hub**: [`alexbic/zerotier-sidecar`](https://hub.docker.com/r/alexbic/zerotier-sidecar)
```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–µ—Ä—Å–∏—é —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π gateway
docker pull alexbic/zerotier-sidecar:gateway

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–≥ latest (—É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ gateway)
docker pull alexbic/zerotier-sidecar:latest
```

**GitHub Container Registry**: [`ghcr.io/alexbic/zerotier-sidecar`](https://github.com/alexbic/zerotier-sidecar/pkgs/container/zerotier-sidecar)
```bash
docker pull ghcr.io/alexbic/zerotier-sidecar:latest
```

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- **üîê –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—è –ø–æ—Ä—Ç–æ–≤**: –ì–∏–±–∫–æ–µ –º–∞–ø–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
- **üè∑Ô∏è –†–µ–∑–æ–ª–≤–∏–Ω–≥ –∏–º–µ–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–º–µ–Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –≤–º–µ—Å—Ç–æ IP –≤ –ø—Ä–∞–≤–∏–ª–∞—Ö –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏–∏
- **üì¶ –ü—Ä–æ—Å—Ç–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ**: –û–¥–∏–Ω Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –ø—Ä–æ—Å—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
- **üåê –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ZeroTier**: –ë–µ—Å—à–æ–≤–Ω—ã–π –º–æ—Å—Ç –º–µ–∂–¥—É —Å–µ—Ç—è–º–∏
- **üõ°Ô∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ firewall —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ä—Ç–æ–≤
- **üîç –£–º–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ DNS**: –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π DNS Docker –¥–ª—è –±–µ—Å—à–æ–≤–Ω–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤

### –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã (–ù–û–í–û–ï –≤ v2.0)
- **–†–µ–∂–∏–º Backend**: –¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–∞—è –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—è ZeroTier ‚Üí Docker
- **–†–µ–∂–∏–º Gateway**: –¢—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç ‚Üí ZeroTier —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø—Ä–æ–∫—Å–∏
- **–ì–∏–±—Ä–∏–¥–Ω—ã–π —Ä–µ–∂–∏–º**: –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—è

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–ù–û–í–û–ï –≤ v2.0)
- **üîç –£–º–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ ZeroTier vs Docker —Å–µ—Ç–µ–π
- **üéØ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö —Ç–æ–ø–æ–ª–æ–≥–∏–π
- **üîí –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤**: –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ IP
- **üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏**: –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å (–£–ª—É—á—à–µ–Ω–æ –≤ v2.2.0!)
- **üì∫ –õ–æ–≥–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ `docker logs` —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –∏–º—ë–Ω —Å–µ—Ä–≤–∏—Å–æ–≤
- **üéöÔ∏è –ì–∏–±–∫–∏–µ —Ä–µ–∂–∏–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è**: off/simple/full - –≤—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å –≤—ã–≤–æ–¥–∞ –¥–ª—è –≤–∞—à–∏—Ö –Ω—É–∂–¥
- **üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø—Ä–∞–≤–∏–ª iptables/socat
- **üíö –ü—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è**: –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ (–∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥)
- **üìä –ú–∞–ø–ø–∏–Ω–≥ –∏–º—ë–Ω —Å–µ—Ä–≤–∏—Å–æ–≤**: –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∏–º–µ–Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –≤–º–µ—Å—Ç–µ —Å IP (`rsync-server (172.22.0.3)`)
- **üìù –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏–º–µ–Ω–∞ –≤ –≤—ã–≤–æ–¥–µ port forwarding
- **üîÅ –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ (–ª–∏–º–∏—Ç 10MB, 5 –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤)
- **‚ö†Ô∏è –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è**: –û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∏ –ª–æ–≥–∏—Ä—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤

## üéØ –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –†–µ–∂–∏–º Backend (–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π)
- **üè† –î–æ—Å—Ç—É–ø –∫ –¥–æ–º–∞—à–Ω–µ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏**: –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –¥–æ–º–∞—à–Ω–∏–º —Å–µ—Ä–≤–∏—Å–∞–º –æ—Ç–∫—É–¥–∞ —É–≥–æ–¥–Ω–æ
- **üíæ –£–¥–∞–ª–µ–Ω–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í–∫–ª—é—á–µ–Ω–∏–µ rsync, NAS –∏–ª–∏ —Å–ª—É–∂–± —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ ZeroTier
- **üñ•Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞**: –£–¥–∞–ª–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å—Ä–µ–¥–∞–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –†–µ–∂–∏–º Gateway (–ù–û–í–û–ï!)
- **üåâ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ç—É–Ω–Ω–µ–ª–∏**: –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ø–æ—á–µ–∫ –¥–æ—Å—Ç—É–ø–∞ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç‚ÜíZeroTier‚Üí–°–µ—Ä–≤–∏—Å—ã
- **üîí Jump —Å–µ—Ä–≤–µ—Ä—ã**: –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –≤ —á–∞—Å—Ç–Ω—ã–µ —Å–µ—Ç–∏  
- **üè¢ –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –¥–æ—Å—Ç—É–ø**: –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–π –≤–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —Å–µ—Ä–≤–∏—Å–∞–º
- **üåç –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ**: –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å–∞–º –≤ —Ä–∞–∑–Ω—ã—Ö –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
- **üì° IoT –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ**: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ IoT —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —á–µ—Ä–µ–∑ —Å–ª–æ–∂–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ —Ç–æ–ø–æ–ª–æ–≥–∏–∏
- **üîß –°–∏—Å—Ç–µ–º–Ω–æ–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ú–Ω–æ–≥–æ—à–∞–≥–æ–≤—ã–π SSH –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏
- **üîÑ –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏**: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞ –ø–æ ZeroTier —Å–µ—Ç—è–º

## üìã –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –†–µ–∂–∏–º Backend (–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π)
```
ZeroTier –∫–ª–∏–µ–Ω—Ç ‚Üí ZeroTier —Å–µ—Ç—å ‚Üí Sidecar (iptables) ‚Üí Docker —Å–µ—Ä–≤–∏—Å
                                  (172.26.0.2)        (172.26.0.3:873)
```

### –†–µ–∂–∏–º Gateway (–ù–û–í–û–ï!)
```
–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –∫–ª–∏–µ–Ω—Ç ‚Üí Gateway Sidecar (socat) ‚Üí ZeroTier ‚Üí Backend Sidecar (iptables) ‚Üí Docker —Å–µ—Ä–≤–∏—Å
                (203.0.113.100)  (172.26.0.2:8989)            (10.121.15.16:8989)    (172.20.0.2:8080)
```

### –ì–∏–±—Ä–∏–¥–Ω—ã–π —Ä–µ–∂–∏–º
```
–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –∫–ª–∏–µ–Ω—Ç ‚îÄ‚îÄ‚îê
                  ‚îú‚Üí –ì–∏–±—Ä–∏–¥–Ω—ã–π Sidecar ‚Üê‚îÄ ZeroTier –∫–ª–∏–µ–Ω—Ç
ZeroTier –∫–ª–∏–µ–Ω—Ç ‚îÄ‚îÄ‚îò     (–≤—Å–µ —Ä–µ–∂–∏–º—ã)
                            ‚Üì
                     Docker —Å–µ—Ä–≤–∏—Å—ã
```

## üìã –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –†–µ–∂–∏–º Backend (–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π)

1. **–°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞**:
```bash
mkdir zerotier-backend && cd zerotier-backend
```

2. **–°–æ–∑–¥–∞–π—Ç–µ `docker-compose.yml`**:
```yaml
version: "3.8"

services:
  zerotier-sidecar:
    # –î–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ Docker Hub –∏–ª–∏ GitHub Container Registry
    image: alexbic/zerotier-sidecar:latest
    # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: ghcr.io/alexbic/zerotier-sidecar:latest
    container_name: zerotier-sidecar
    restart: unless-stopped
    privileged: true
    devices:
      - /dev/net/tun:/dev/net/tun
    volumes:
      - ./sidecar-data:/var/lib/zerotier-one      # ZeroTier –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
      - ./sidecar-logs:/var/log/zerotier-sidecar  # –õ–æ–≥–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (–ù–û–í–û–ï!)
      - /var/log/kern.log:/var/log/kern.log:ro     # Kernel log (–æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π)
    networks:
      - default
    env_file:
      - .env
    environment:
      # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–º–æ–≥—É—Ç –±—ã—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ —Ñ–∞–π–ª–µ .env)
      - GATEWAY_MODE=${GATEWAY_MODE:-false}
      - ALLOWED_SOURCES=${ALLOWED_SOURCES:-any}
    cap_add:
      - NET_ADMIN
      - SYS_ADMIN

networks:
  default:
    name: sidecar_net
```

3. **–°–æ–∑–¥–∞–π—Ç–µ `.env`**:
```bash
# –†–µ–∂–∏–º backend (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
ZT_NETWORK=–≤–∞—à_id_zerotier_—Å–µ—Ç–∏_–∑–¥–µ—Å—å
# –ü–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—è –ø–æ—Ä—Ç–æ–≤: –í–ù–ï–®–ù–ò–ô_–ü–û–†–¢:IP_–ò–õ–ò_–ò–ú–Ø_–ù–ê–ó–ù–ê–ß–ï–ù–ò–Ø:–ü–û–†–¢_–ù–ê–ó–ù–ê–ß–ï–ù–ò–Ø
# –í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–º–µ–Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∏–ª–∏ IP –∞–¥—Ä–µ—Å–∞!
PORT_FORWARD=873:my-rsync-server:873,22:my-ssh-server:22
GATEWAY_MODE=false
```

### –†–µ–∂–∏–º Gateway (–ù–û–í–û–ï!)

1. **Gateway —Å–µ—Ä–≤–µ—Ä - `docker-compose.yml`**:
```yaml
version: "3.8"

services:
  zerotier-gateway:
    image: alexbic/zerotier-sidecar:gateway
    container_name: zerotier-gateway
    restart: unless-stopped
    privileged: true
    devices:
      - /dev/net/tun:/dev/net/tun
    ports:
      - "8989:8989"  # –û—Ç–∫—Ä—ã—Ç –¥–ª—è –ò–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
      - "443:443"    # HTTPS –¥–æ—Å—Ç—É–ø
    volumes:
      - ./gateway-data:/var/lib/zerotier-one
    env_file:
      - .env
    cap_add:
      - NET_ADMIN
      - SYS_ADMIN
```

2. **Gateway —Å–µ—Ä–≤–µ—Ä - `.env`**:
```bash
# –†–µ–∂–∏–º gateway - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –∏–∑ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∏ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å—É–µ—Ç –≤ ZeroTier
ZT_NETWORK=–≤–∞—à_id_zerotier_—Å–µ—Ç–∏_–∑–¥–µ—Å—å
PORT_FORWARD=8989:10.121.15.16:8989,443:10.121.15.20:443
GATEWAY_MODE=true
ALLOWED_SOURCES=203.0.113.0/24  # –í–∞—à–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –∏—Å—Ö–æ–¥–Ω—ã–µ —Å–µ—Ç–∏
```

3. **Backend —Å–µ—Ä–≤–µ—Ä - `.env`**:
```bash
# –†–µ–∂–∏–º backend - –ø–æ–ª—É—á–∞–µ—Ç –∏–∑ ZeroTier –∏ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å—É–µ—Ç –≤ Docker
ZT_NETWORK=–≤–∞—à_id_zerotier_—Å–µ—Ç–∏_–∑–¥–µ—Å—å
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–º–µ–Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –¥–ª—è –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
PORT_FORWARD=8989:my-web-app:8080,443:my-api-service:443
GATEWAY_MODE=false
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –ü—Ä–∏–º–µ—Ä |
|------------|--------------|-----------|--------------|---------|
| `ZT_NETWORK` | ‚úÖ | ID ZeroTier —Å–µ—Ç–∏ | - | `a03edd986708c010` |
| `PORT_FORWARD` | ‚úÖ | –ü—Ä–∞–≤–∏–ª–∞ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏–∏ –ø–æ—Ä—Ç–æ–≤ | - | `8989:10.121.15.16:8989` |
| `GATEWAY_MODE` | ‚ùå | –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã | `false` | `false`, `true`, `hybrid` |
| `ALLOWED_SOURCES` | ‚ùå | –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ IP –∏—Å—Ç–æ—á–Ω–∏–∫–∏ | `any` | `203.0.113.0/24,10.0.0.0/8` |
| `FORCE_ZEROTIER_ROUTES` | ‚ùå | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ ZeroTier –º–∞—Ä—à—Ä—É—Ç—ã | - | `192.168.1.0/24:10.121.15.50` |
| `LOG_CONNECTIONS` | ‚ùå | –†–µ–∂–∏–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π | `false` | `off`, `simple`, `full` |

### –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

- **`GATEWAY_MODE=false`** (Backend): ZeroTier ‚Üí Docker (—Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π —Ä–µ–∂–∏–º)
- **`GATEWAY_MODE=true`** (Gateway): –ò–Ω—Ç–µ—Ä–Ω–µ—Ç ‚Üí ZeroTier (–Ω–æ–≤—ã–π —Ä–µ–∂–∏–º)  
- **`GATEWAY_MODE=hybrid`** (–ì–∏–±—Ä–∏–¥–Ω—ã–π): –û–±–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

### –§–æ—Ä–º–∞—Ç –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏–∏ –ø–æ—Ä—Ç–æ–≤

**–ë–∞–∑–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç**: `–í–ù–ï–®–ù–ò–ô_–ü–û–†–¢:IP_–ò–õ–ò_–ò–ú–Ø_–ù–ê–ó–ù–ê–ß–ï–ù–ò–Ø:–ü–û–†–¢_–ù–ê–ó–ù–ê–ß–ï–ù–ò–Ø`

**–ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∂–∏–º–∞ Backend**:
```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–º–µ–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è - –ª–µ–≥—á–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å)
PORT_FORWARD=873:my-rsync-server:873,22:my-ssh-server:22,80:my-web-app:8080

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ IP –∞–¥—Ä–µ—Å–æ–≤ (—Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –º–µ–Ω–µ–µ –≥–∏–±–∫–æ)
PORT_FORWARD=873:172.26.0.3:873,22:172.26.0.4:22,80:172.26.0.5:8080
```

**–ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∂–∏–º–∞ Gateway**:
```bash
# –ü–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—è –Ω–∞ ZeroTier IP
PORT_FORWARD=8989:10.121.15.16:8989,443:10.121.15.20:443
```

**‚ö†Ô∏è –í–ê–ñ–ù–û - –ü—É–±–ª–∏–∫–∞—Ü–∏—è –ø–æ—Ä—Ç–æ–≤ –≤ Gateway —Ä–µ–∂–∏–º–µ**:

–í **Gateway —Ä–µ–∂–∏–º–µ** **–ø–µ—Ä–≤—ã–π –ø–æ—Ä—Ç** –≤ `PORT_FORWARD` (EXTERNAL_PORT) –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω –∫–ª–∏–µ–Ω—Ç–∞–º. –ï—Å—Ç—å –¥–≤–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è:

**–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞** (sidecar –æ—Ç–∫—Ä—ã—Ç –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç)
```yaml
services:
  zerotier-sidecar:
    image: alexbic/zerotier-sidecar:gateway
    ports:
      - "8989:8989"  # ‚úÖ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û - –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –Ω–∞ —Ö–æ—Å—Ç (0.0.0.0:8989)
      - "443:443"    # ‚úÖ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û - –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –Ω–∞ —Ö–æ—Å—Ç
    environment:
      - PORT_FORWARD=8989:10.121.15.16:8989,443:10.121.15.20:443
```

**–°—Ü–µ–Ω–∞—Ä–∏–π 2: –ó–∞ –æ–±—Ä–∞—Ç–Ω—ã–º –ø—Ä–æ–∫—Å–∏** (nginx/traefik –≤–ø–µ—Ä–µ–¥–∏)
```yaml
services:
  zerotier-sidecar:
    image: alexbic/zerotier-sidecar:gateway
    expose:
      - "8989"  # ‚úÖ –¢–æ–ª—å–∫–æ –¥–ª—è Docker —Å–µ—Ç–∏, –ù–ï –Ω–∞ —Ö–æ—Å—Ç
    networks:
      - proxy_network  # ‚úÖ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –≤ –æ–¥–Ω–æ–π —Å–µ—Ç–∏ —Å –ø—Ä–æ–∫—Å–∏
    environment:
      - PORT_FORWARD=8989:10.121.15.16:8989

  nginx-proxy:
    image: nginx
    ports:
      - "80:80"  # –ü—Ä–æ–∫—Å–∏ –ø—É–±–ª–∏–∫—É–µ—Ç –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
    networks:
      - proxy_network  # ‚úÖ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –≤ –æ–¥–Ω–æ–π —Å–µ—Ç–∏ —Å sidecar

networks:
  proxy_network:
```

**–ö–ª—é—á–µ–≤—ã–µ —Ä–∞–∑–ª–∏—á–∏—è**:
- **`ports:`** - –ü—É–±–ª–∏–∫—É–µ—Ç –Ω–∞ —Ö–æ—Å—Ç (–¥–æ—Å—Ç—É–ø–Ω–æ –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞)
- **`expose:`** - –î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º –≤ —Ç–æ–π –∂–µ —Å–µ—Ç–∏
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø—Ä–æ–∫—Å–∏**: Sidecar –∏ –ø—Ä–æ–∫—Å–∏ **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –æ–¥–Ω–æ–π Docker —Å–µ—Ç–∏**

**Backend —Ä–µ–∂–∏–º** –ù–ï —Ç—Ä–µ–±—É–µ—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø–æ—Ä—Ç–æ–≤ - —Ç—Ä–∞—Ñ–∏–∫ –∏–¥–µ—Ç —á–µ—Ä–µ–∑ ZeroTier —Å–µ—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ.

**–†–µ–∑–æ–ª–≤–∏–Ω–≥ –∏–º–µ–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤**:
- –ò–º–µ–Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–∑–æ–ª–≤—è—Ç—Å—è –≤ IP –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- –†–∞–±–æ—Ç–∞–µ—Ç —Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ –≤ –æ–¥–Ω–æ–π Docker —Å–µ—Ç–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π DNS Docker (127.0.0.11) –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–≥–æ —Ä–µ–∑–æ–ª–≤–∏–Ω–≥–∞
- –û—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—ã–π DNS –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –û–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–µ —Ä–µ–∑–æ–ª–≤–∏–Ω–≥ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—É—é –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è (–ù–û–í–û–ï!)

–î–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö —Ç–æ–ø–æ–ª–æ–≥–∏–π, –≥–¥–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ ZeroTier:

```bash
# –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —á–∞—Å—Ç–Ω—ã—Ö —Å–µ—Ç–µ–π —á–µ—Ä–µ–∑ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ ZeroTier —à–ª—é–∑—ã
FORCE_ZEROTIER_ROUTES=192.168.1.0/24:10.121.15.50,10.0.0.0/16:10.121.15.100

# –ü—Ä–∏–º–µ—Ä: –î–æ—Å—Ç—É–ø –∫ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Å–µ—Ç–∏ —á–µ—Ä–µ–∑ ZeroTier
PORT_FORWARD=3389:192.168.10.100:3389,22:192.168.20.50:22
FORCE_ZEROTIER_ROUTES=192.168.10.0/24:10.121.15.10,192.168.20.0/24:10.121.15.20
```

## üîê –°–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –°–µ—Ç–µ–≤–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **–ò–∑–æ–ª—è—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–µ Docker —Å–µ—Ç–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π —Å–µ—Ä–≤–∏—Å–æ–≤
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: –í—Å–µ–≥–¥–∞ –∞–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ ZeroTier Central
- **Firewall**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ iptables —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ä—Ç–æ–≤
- **–ö–æ–Ω—Ç—Ä–æ–ª—å –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `ALLOWED_SOURCES` –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞

### –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

**–í–ê–ñ–ù–û**: –í –ø—Ä–æ–¥–∞–∫—à–Ω —Å—Ä–µ–¥–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã—Å—Ç–∞–≤–ª—è–π—Ç–µ –ø–æ—Ä—Ç—ã sidecar –Ω–∞–ø—Ä—è–º—É—é –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç. –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ–∫—Å–∏.

#### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
```
–ò–Ω—Ç–µ—Ä–Ω–µ—Ç ‚Üí –û–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ–∫—Å–∏ (80/443) ‚Üí –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å–µ—Ç—å ‚Üí ZeroTier Sidecar ‚Üí –°–µ—Ä–≤–∏—Å—ã
          (nginx/traefik)               (Docker —Å–µ—Ç—å)
```

#### –ü—Ä–∏–º–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:
```yaml
# docker-compose.yml - –ü–†–û–î–ê–ö–®–ù –£–°–¢–ê–ù–û–í–ö–ê
version: "3.8"

services:
  # –û–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ–∫—Å–∏ - –ï–î–ò–ù–°–¢–í–ï–ù–ù–´–ô —Å–µ—Ä–≤–∏—Å, –æ—Ç–∫—Ä—ã—Ç—ã–π –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
  nginx-proxy:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"    # –¢–û–õ–¨–ö–û —ç—Ç–∏ –ø–æ—Ä—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
    networks:
      - frontend
      - backend

  # ZeroTier Gateway - –ë–ï–ó –≤–Ω–µ—à–Ω–∏—Ö –ø–æ—Ä—Ç–æ–≤
  zerotier-gateway:
    image: alexbic/zerotier-sidecar:gateway
    container_name: zerotier-gateway
    privileged: true
    devices:
      - /dev/net/tun:/dev/net/tun
    # –ë–ï–ó —Å–µ–∫—Ü–∏–∏ ports - —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –¥–æ—Å—Ç—É–ø
    networks:
      - backend
    environment:
      - ZT_NETWORK=–≤–∞—à_id_—Å–µ—Ç–∏
      - PORT_FORWARD=8989:10.121.15.16:8989
      - GATEWAY_MODE=true
      - ALLOWED_SOURCES=172.18.0.0/16  # –¢–æ–ª—å–∫–æ –∏–∑ docker —Å–µ—Ç–∏

networks:
  frontend:
    driver: bridge
  backend:
    driver: bridge
```

#### –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx:
```nginx
# nginx.conf
upstream zerotier_backend {
    server zerotier-gateway:8989;  # –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –∏–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:–ø–æ—Ä—Ç
}

server {
    listen 80;
    server_name –≤–∞—à–¥–æ–º–µ–Ω.com;

    location / {
        proxy_pass http://zerotier_backend;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

#### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –∞—Ç–∞–∫–∏**: –¢–æ–ª—å–∫–æ 80/443 –æ—Ç–∫—Ä—ã—Ç—ã –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
- **SSL —Ç–µ—Ä–º–∏–Ω–∞—Ü–∏—è**: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ–∫—Å–∏
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤**: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è sidecar
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏**: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ–∫—Å–∏
- **–ó–∞—â–∏—Ç–∞ –æ—Ç DDoS**: –ü—Ä–æ–∫—Å–∏ –º–æ–∂–µ—Ç –æ–±–µ—Å–ø–µ—á–∏—Ç—å –∑–∞—â–∏—Ç—É –æ—Ç DDoS
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞

### –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏
- **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã—Å—Ç–∞–≤–ª—è–π—Ç–µ –ø–æ—Ä—Ç—ã sidecar –Ω–∞–ø—Ä—è–º—É—é** - –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ–∫—Å–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `GATEWAY_MODE=hybrid` —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è/–æ—Ç–ª–∞–¥–∫–∏
- –†–µ–∞–ª–∏–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –ø–æ—Ç–æ–∫–∞ ZeroTier –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞
- –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –∞—É–¥–∏—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –Ω–∞ —Ü–µ–ª–µ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ fail2ban –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—É—é —Å–∏—Å—Ç–µ–º—É –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –≤—Ç–æ—Ä–∂–µ–Ω–∏–π
- –†–µ–≥—É–ª—è—Ä–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π ZeroTier

## üìù –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (–£–ª—É—á—à–µ–Ω–æ –≤ v2.2.0!)

ZeroTier Sidecar –≤–∫–ª—é—á–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π.

### –†–µ–∂–∏–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π (–ù–û–í–û–ï –≤ v2.2.0!)

–£–ø—Ä–∞–≤–ª—è–π—Ç–µ –≤—ã–≤–æ–¥–æ–º –ª–æ–≥–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π —Å –ø–æ–º–æ—â—å—é –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è `LOG_CONNECTIONS`:

| –†–µ–∂–∏–º | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ |
|-------|----------|-----------|
| `off` / `false` | –õ–æ–≥–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –Ω–µ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å | Production (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥) |
| `simple` | –õ–æ–≥–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π —Å –∏–º–µ–Ω–∞–º–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ |
| `full` | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è + –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ª–æ–≥–∏ iptables | –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –æ—Ç–ª–∞–¥–∫–∞ |

**–ü—Ä–∏–º–µ—Ä—ã:**
```yaml
environment:
  - LOG_CONNECTIONS=simple  # –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: "10.121.15.69 ‚Üí 172.22.0.3 (rsync-server):873"
  - LOG_CONNECTIONS=full    # –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è + –¥–µ—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª iptables
  - LOG_CONNECTIONS=off     # –û—Ç–∫–ª—é—á–∏—Ç—å –≤—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å (–ª–æ–≥–∏ –≤—Å–µ —Ä–∞–≤–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–∞–π–ª)
```

**–í—ã–≤–æ–¥ –≤ —Ä–µ–∂–∏–º–µ Simple** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production):
```
[Nov 13 01:15:42] 10.121.15.69 ‚Üí 172.22.0.3 (rsync-server):873
[Nov 13 01:16:20] 192.168.1.100 ‚Üí 10.121.15.16 (sonarr):8989
```

**–í—ã–≤–æ–¥ –≤ —Ä–µ–∂–∏–º–µ Full** (–¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏):
```
[Nov 13 01:15:42] 10.121.15.69 ‚Üí 172.22.0.3 (rsync-server):873
[DBG-FORWARD] IN=zthbm5kwdx OUT=docker0 SRC=10.121.15.69 DST=172.22.0.3 PROTO=TCP DPT=873
[DBG-NAT-PREROUTING] IN=zthbm5kwdx SRC=10.121.15.69 DST=10.121.15.15 PROTO=TCP DPT=873
```

### –§–∞–π–ª—ã –ª–æ–≥–æ–≤

–í—Å–µ –ª–æ–≥–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `/var/log/zerotier-sidecar/` –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

| –§–∞–π–ª –ª–æ–≥–∞ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°–æ–¥–µ—Ä–∂–∏–º–æ–µ |
|-----------|-----------|------------|
| `monitor.log` | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–∏—Å–æ–≤ | –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤, –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª |
| `connections.log` | –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π | –ù–æ–≤—ã–µ TCP –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏ |

### –ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–æ–≤

**–õ–æ–≥ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞** (`/var/log/zerotier-sidecar/monitor.log`):
```
[2025-11-10 19:20:15] [INFO] Service monitor started (PID: 427)
[2025-11-10 19:20:45] [WARN] Service DOWN: rsync-server (172.22.0.3):873 (port 873)
[2025-11-10 19:21:15] [INFO] Service RESTORED: rsync-server (172.22.0.3):873 (port 873) - service is back online
[2025-11-10 19:22:30] [WARN] Rules missing for port 873 -> rsync-server (172.22.0.3):873 - restoring...
[2025-11-10 19:22:31] [INFO] Rules RESTORED: port 873 -> rsync-server (172.22.0.3):873
[2025-11-10 19:30:15] [INFO] Health check: All services healthy (3 rules checked, 1 total restorations)
```

**–õ–æ–≥ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π** (`/var/log/zerotier-sidecar/connections.log`):
```
[2025-11-10 19:25:10] NEW CONNECTION: 10.121.15.100 -> 172.22.0.3:873 (port 873)
[2025-11-10 19:26:22] NEW CONNECTION: 10.121.15.101 -> 172.22.0.4:22 (port 22)
[2025-11-10 19:27:45] NEW CONNECTION: 203.0.113.50 -> 10.121.15.16:8989 (port 8989)
```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

- **üîç –ú–∞–ø–ø–∏–Ω–≥ –∏–º—ë–Ω —Å–µ—Ä–≤–∏—Å–æ–≤** (–ù–û–í–û–ï –≤ v2.2.0): –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∏–º–µ–Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –≤ –ª–æ–≥–∞—Ö (`172.22.0.3 (rsync-server):873`)
- **üì∫ –í—ã–≤–æ–¥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** (–ù–û–í–û–ï –≤ v2.2.0): –õ–æ–≥–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –≤–∏–¥–Ω—ã –≤ `docker logs` —Å `LOG_CONNECTIONS=simple`
- **üéöÔ∏è –ì–∏–±–∫–∏–µ —É—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è** (–ù–û–í–û–ï –≤ v2.2.0): –¢—Ä–∏ —Ä–µ–∂–∏–º–∞ - off/simple/full –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- **üìù –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** (–ù–û–í–û–ï –≤ v2.2.0): –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏–º–µ–Ω–∞, –∞ –Ω–µ —Ä–µ–∑–æ–ª–≤–Ω—É—Ç—ã–µ IP
- **‚è∞ –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏**: –í—Å–µ –∑–∞–ø–∏—Å–∏ –≤–∫–ª—é—á–∞—é—Ç —Ç–æ—á–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `YYYY-MM-DD HH:MM:SS`
- **üîÅ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è**: –§–∞–π–ª—ã –ª–æ–≥–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–æ—Ç–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ 10MB
- **üìö –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏**: –•—Ä–∞–Ω–∏—Ç—Å—è –¥–æ 5 —Ä–æ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –ª–æ–≥–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `monitor.log.1`, `monitor.log.2`, ...)
- **‚ö° –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã**: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å —á–∞—Å—Ç–æ—Ç–æ–π –¥–æ 3/–º–∏–Ω—É—Ç—É –Ω–∞ –ø–æ—Ä—Ç –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –ª–æ–≥–æ–≤
- **üéØ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è**: –õ–æ–≥–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è (DOWN ‚Üí UP) –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —à—É–º–∞

### –î–æ—Å—Ç—É–ø –∫ –ª–æ–≥–∞–º

**–ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–º–∞ –¥–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã—Ö –ª–æ–≥–æ–≤**:
```yaml
volumes:
  - ./sidecar-logs:/var/log/zerotier-sidecar  # –õ–æ–≥–∏ –≤—ã–∂–∏–≤–∞—é—Ç –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
```

**–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏**:
```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ —Å–µ—Ä–≤–∏—Å–æ–≤
docker exec zerotier-sidecar tail -f /var/log/zerotier-sidecar/monitor.log

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
docker exec zerotier-sidecar tail -f /var/log/zerotier-sidecar/connections.log

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 50 —Å—Ç—Ä–æ–∫
docker exec zerotier-sidecar tail -n 50 /var/log/zerotier-sidecar/monitor.log
```

**–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–æ–≤ –Ω–∞ —Ö–æ—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞**:
```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –ª–æ–≥–∏
docker cp zerotier-sidecar:/var/log/zerotier-sidecar ./logs

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å volume mount (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
# –õ–æ–≥–∏ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –≤ ./sidecar-logs/ –Ω–∞ —Ö–æ—Å—Ç–µ
```

### –ß—Ç–æ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—Å—è

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–∏—Å–æ–≤** (–∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥):
- ‚úÖ –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–∞ (TCP –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è)
- ‚úÖ –ù–∞–ª–∏—á–∏–µ –ø—Ä–∞–≤–∏–ª iptables
- ‚úÖ –ü—Ä–æ—Ü–µ—Å—Å—ã socat (–¥–ª—è Gateway —Ä–µ–∂–∏–º–∞)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø—Ä–∞–≤–∏–ª
- ‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤

**–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π** (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏):
- ‚úÖ –ù–æ–≤—ã–µ TCP –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- ‚úÖ –ò—Å—Ö–æ–¥–Ω—ã–π IP –∞–¥—Ä–µ—Å
- ‚úÖ –¶–µ–ª–µ–≤–æ–π IP –∏ –ø–æ—Ä—Ç
- ‚úÖ –ö–∞–∫–æ–π —Å–µ—Ä–≤–∏—Å –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø

### –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤

–õ–æ–≥–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–æ—Ç–∏—Ä—É—é—Ç—Å—è –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∏—Å–∫–∞:

```
/var/log/zerotier-sidecar/
‚îú‚îÄ‚îÄ monitor.log         # –¢–µ–∫—É—â–∏–π —Ñ–∞–π–ª (–¥–æ 10MB)
‚îú‚îÄ‚îÄ monitor.log.1       # –ü—Ä–µ–¥—ã–¥—É—â–∞—è —Ä–æ—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ monitor.log.2
‚îú‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ monitor.log.5       # –°–∞–º—ã–π —Å—Ç–∞—Ä—ã–π (–∑–∞—Ç–µ–º —É–¥–∞–ª—è–µ—Ç—Å—è)
‚îú‚îÄ‚îÄ connections.log     # –¢–µ–∫—É—â–∏–π —Ñ–∞–π–ª (–¥–æ 10MB)
‚îú‚îÄ‚îÄ connections.log.1
‚îî‚îÄ‚îÄ ...
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ä–µ–∂–∏–º–µ
docker logs zerotier-sidecar

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
docker exec zerotier-sidecar cat /tmp/zt-sidecar/config.json

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ ZeroTier
docker exec zerotier-sidecar zerotier-cli listnetworks

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
docker exec zerotier-sidecar ip route show

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (–ù–û–í–û–ï –≤ v2.1.4!)
docker exec zerotier-sidecar tail -f /var/log/zerotier-sidecar/monitor.log

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π (–ù–û–í–û–ï –≤ v2.1.4!)
docker exec zerotier-sidecar tail -f /var/log/zerotier-sidecar/connections.log
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏–∏ –ø–æ—Ä—Ç–æ–≤
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–µ–º—ã—Ö –ø–æ—Ä—Ç–æ–≤
docker exec zerotier-sidecar ss -tulpn

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª iptables
docker exec zerotier-sidecar iptables -L -n -v
docker exec zerotier-sidecar iptables -t nat -L -n -v

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ socat (—Ä–µ–∂–∏–º Gateway)
docker exec zerotier-sidecar ps aux | grep socat
```

### –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞**: –°–æ–µ–¥–∏–Ω–µ–Ω–∏—è –≤ —Ä–µ–∂–∏–º–µ Gateway –∏—Å—Ç–µ–∫–∞—é—Ç –ø–æ —Ç–∞–π–º–∞—É—Ç—É
- **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å**: –ü–æ—Ä—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã –≤ —Å–µ–∫—Ü–∏–∏ `ports` –≤ `docker-compose.yml`
- **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å**: `GATEWAY_MODE=true` –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ - —ç—Ç–æ ZeroTier –∞–¥—Ä–µ—Å
- **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å**: Firewall —Ä–∞–∑—Ä–µ—à–∞–µ—Ç gateway –ø–æ—Ä—Ç—ã –Ω–∞ —Ö–æ—Å—Ç–µ

**–ü—Ä–æ–±–ª–µ–º–∞**: –†–µ–∂–∏–º Backend –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å**: –¶–µ–ª–µ–≤–æ–π —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π Docker —Å–µ—Ç–∏
- **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å**: ZeroTier –∫–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –¥–æ—Å—Ç–∏—á—å IP sidecar
- **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å**: –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã –≤ ZeroTier Central

**–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
- **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å**: –§–æ—Ä–º–∞—Ç `FORCE_ZEROTIER_ROUTES`: `–°–ï–¢–¨:–®–õ–Æ–ó`
- **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å**: IP —à–ª—é–∑–∞ –¥–æ—Å—Ç–∏–∂–∏–º –≤ ZeroTier —Å–µ—Ç–∏
- **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å**: –¶–µ–ª–µ–≤–∞—è —Å–µ—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å v1.x –Ω–∞ v2.x

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
–í—Å–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ v1.x —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ v2.x:
```bash
# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è v1.x (–≤—Å–µ –µ—â–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ v2.x)
ZT_NETWORK=–≤–∞—à_id_—Å–µ—Ç–∏
PORT_FORWARD=873:172.26.0.3:873
# GATEWAY_MODE –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 'false' (—Ä–µ–∂–∏–º backend)
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ Gateway —Ñ—É–Ω–∫—Ü–∏–π
```bash
# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ gateway —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —É—Å—Ç–∞–Ω–æ–≤–∫–µ
GATEWAY_MODE=true  # –í–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º gateway
ALLOWED_SOURCES=–≤–∞—à.–≤–Ω–µ—à–Ω–∏–π.ip/32  # –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø
```

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

–í–∫–ª–∞–¥—ã –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è! –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å Pull Request.

1. –°–¥–µ–ª–∞–π—Ç–µ —Ñ–æ—Ä–∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É —Ñ—É–Ω–∫—Ü–∏–∏ (`git checkout -b feature/–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–∞—è–§—É–Ω–∫—Ü–∏—è`)
3. –ó–∞—Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m '–î–æ–±–∞–≤–∏—Ç—å –£–¥–∏–≤–∏—Ç–µ–ª—å–Ω—É—é–§—É–Ω–∫—Ü–∏—é'`)
4. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –≤ –≤–µ—Ç–∫—É (`git push origin feature/–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–∞—è–§—É–Ω–∫—Ü–∏—è`)
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT - —Å–º. —Ñ–∞–π–ª [LICENSE](LICENSE) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.

## üôè –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- [ZeroTier](https://zerotier.com) –∑–∞ –ø–æ—Ç—Ä—è—Å–∞—é—â—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–µ—Ç–µ–π
- [Docker](https://docker.com) –∑–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—é –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏
- –°–æ–æ–±—â–µ—Å—Ç–≤—É –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞ –∑–∞ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- üêõ **–ü—Ä–æ–±–ª–µ–º—ã**: [GitHub Issues](https://github.com/alexbic/zerotier-sidecar/issues)
- üí¨ **–û–±—Å—É–∂–¥–µ–Ω–∏—è**: [GitHub Discussions](https://github.com/alexbic/zerotier-sidecar/discussions)
- üìñ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —ç—Ç–æ—Ç README –∏ –ø—Ä–∏–º–µ—Ä—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

---

‚≠ê **–ï—Å–ª–∏ —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø–æ–º–æ–≥ –≤–∞–º, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥—É!** ‚≠ê
